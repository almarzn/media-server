[Install]
WantedBy=default.target
RequiredBy=protonwire.service

[Container]
ContainerName=protonwire
Image={{ protonwire_image_name }}:{{ protonwire_image_version }}
Tmpfs=/tmp
Secret={{ wireguard.secret_name }},mode=600
Environment=PROTONVPN_SERVER={{ wireguard.server }}
Environment=DEBUG=0
RunInit=true
AddCapability=NET_ADMIN
Sysctl=net.ipv4.conf.all.rp_filter=2 net.ipv6.conf.all.disable_ipv6=1
Notify=true
{% for service,port in wireguard.ports.items()  %}
PublishPort={{ port }}:{{ port }}
{% endfor %}
HealthStartPeriod=20s
HealthInterval=90s
HealthCmd=protonwire check --container --silent
HealthOnFailure=stop
{#Network=pasta#}